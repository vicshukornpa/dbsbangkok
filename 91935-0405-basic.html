<!DOCTYPE html>
<html>
<title>91935-0405-v01</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-blue-grey.css">
<link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<link href="https://fonts.googleapis.com/css2?family=Kanit:wght@200&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<script src="https://static.line-scdn.net/liff/edge/versions/2.9.0/sdk.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<style>
html, body, h1, h2, h3, h4, h5, h6 {font-family: "Kanit", sans-serif}
</style>
<body class="w3-theme-l5">

  <!-- ////////////////////////////////////////////////////////////////////////////////////// -->
  <div id="cbmspinerload" class="w3-center w3-padding-small" style="display: block;">
    <i class="fa fa-spinner w3-spin" style="font-size:64px"></i>
  </div>
  <!-- ////////////////////////////////////////////////////////////////////////////////////// -->
    <div id="cbmmembermenu" class="w3-container w3-center w3-padding" style="display:none; width:90%; margin:auto;">    
      <div class="w3-card w3-white w3-center w3-text-grey w3-padding-16 w3-round">
        <br><img id="cbmmemberimg" src="https://cdn3.iconfinder.com/data/icons/galaxy-open-line-gradient-i/200/account-128.png" alt="Avatar" class="w3-center w3-circle w3-margin-bottom" style="margin:auto;width:80px">
        <div class="w3-center w3-xlarge">สวัสดีครับ</div>
        <div id="cbmmembername" class="w3-center w3-large w3-text-blue">คุณ </div>
        <div class="w3-center w3-large">กรุณาพิมพ์คำถามด้านล่างครับ</div><br>
        <p id="cbmnamebox" contenteditable="true" class="w3-border w3-padding-8 w3-text-grey w3-round w3-margin-bottom"style="width:70%; outline:none; word-wrap:break-word;margin:auto;"></p><br>
        <p id="cbmmsgbox" contenteditable="true" class="w3-border w3-padding-32 w3-text-grey w3-round w3-margin-bottom"style="width:70%; outline:none; word-wrap:break-word;margin:auto;"></p><br>
        <button id="cbmbt01" class="w3-button w3-card w3-padding w3-round-large w3-large w3-white w3-hover-dark-grey w3-hover-text-white w3-margin-bottom" onclick="submit01()" style="display:none;outline:none;margin:auto;"> Submit-1 >> </button>
        <br>
      </div>
    </div>  
  <!-- ////////////////////////////////////////////////////////////////////////////////////// -->
  <div class="w3-container w3-padding-16" style="display:none;">
  <br><input type="text" class="w3-border-0 w3-white w3-text-dark-grey" id="cbmform" style="outline:none" placeholder="form" readonly>
  <br><input type="text" class="w3-border-0 w3-white w3-text-dark-grey" id="cbmqr" style="outline:none" placeholder="qrcode" readonly>
  </div>
  <!-- ////////////////////////////////////////////////////////////////////////////////////// -->
 
<script>
/////////////////////////////////////////////////////////////////////////////////////////// submit01  
function submit01() 
{
    var cbmmsgboxVal = document.getElementById("cbmmsgbox").innerText;
    var cbmnameboxVal = document.getElementById("cbmnamebox").innerText;
    if( cbmmsgboxVal != "" && cbmnameboxVal != "" )
      {
        document.getElementById("cbmmembermenu").style.display = "none";
        document.getElementById("cbmspinerload").style.display = "block";
        var appscripturl = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"; //edit
        preparesubmitdata(appscripturl,cbmmsgboxVal,cbmnameboxVal);
      }
    else
      {
        alert("โปรดกรอกข้อมูลให้ครบถ้วน")
      }
}
/////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////// preparedata
function preparesubmitdata(appscripturl,cbmmsgboxVal,cbmnameboxVal)
{  
  var qrValue = document.getElementById("cbmqr").value;
  var formname = document.getElementById("cbmform").value;
          var webhookdata = 
              { 
                "key00qrValue": qrValue,
                "key01formName": formname, 
                "key02msgValue": cbmmsgboxVal,
                "key03nameValue": cbmnameboxVal
              };
  sendsubmittodb(appscripturl,webhookdata);
}
/////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////// sendsubmittodb
function sendsubmittodb(appscripturl,webhookdata)
{
    $.ajax(
        {
          type: "POST",
          url: appscripturl,
          data: webhookdata,
          dataType: "JSON"
        }
    );
   alert("Message has been sent")
}
/////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////// main
function main() 
{
    const queryString = decodeURIComponent(window.location.search)
    const params = new URLSearchParams(queryString)

        if ( params.get("code") == "ad5sa461234xxx" ){

            var codecheck = params.get("code");

            document.getElementById("cbmform").value = "form-01";
            document.getElementById("cbmqr").value = codecheck;
            document.getElementById("cbmspinerload").style.display = "none";
            document.getElementById("cbmmembermenu").style.display = "block";
            document.getElementById("cbmbt01").style.display = "block";
        }
        else
        {
          alert("ไม่พบกิจกรรมนี้")
          window.close()
        }    
 }
///////////////////////////////////////////////////////////////////////////////////////////// 
    main();
/////////////////////////////////////////////////////////////////////////////////////////////
</script>

</body>
</html> 

